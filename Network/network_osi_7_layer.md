# OSI 7계층
## 1 정의
    네트워크 통신 과정을 7단계로 나눈 국제 표준 모델이다.
- **계층을 나눈 이유**
    OSI 7계층은 복잡한 네트워크 통신 과정을 역할 별로 나눠서 표준화하고 유연하게 관리하기 위해 설계된 모델이다.

## 2 계층별 특징
### 1계층: 물리(Physical)
    전송 매체를 통해 0과 1의 신호(비트)를 전송하는 계층이다.  
    → 데이터의 실제 전송이 일어난다.
- **데이터 단위**
    비트(bit)
- **대표 장비**
    허브, 리피터, 케이블(UTP, 광섬유)

### 2계층: 데이터 링크(Data Link)
    물리 계층을 통해 프레임 단위로 데이터를 전달한다.  
    CRC로 오류를 검출하고, 손상 프레임은 폐기한다.
- **데이터 단위**
    프레임(Frame)
- **주요 기능**
    - **오류 검출**
        송신 측에서 프레임에 검사 비트(Checksum, CRC 등)를 추가해 전송한다.  
        → 수신 측에서 프레임을 받은 후 검사 비트를 계산하고 비교한다.  
        → 두 값이 다르면 전송 중 오류가 발생했다고 판단하고 폐기한다.  
        (오류를 검출하지만, 재전송은 상위 계층이 담당한다.)
        - **오류 검출 방식**
            **패리티 비트(Parity Bit)**
                → 데이터의 1의 개수를 세서 짝수 또는 홀수가 되도록 마지막에 1비트를 추가  
                → 수신 측에서 받은 데이터의 1의 개수를 세서 일치 여부 확인
            **CRC(Cyclic Redundancy Check, 순환 중복 검사)**
                → 2계층에서 가장 많이 쓰인다. (특히 Ethernet)  
                → 송신 측은 데이터 비트를 특정 생성다항식으로 나눠 나머지를 구하고 이것을 프레임 끝에 붙인다. (CRC 코드)  
                → 수신 측은 받은 전체 데이터를 같은 다항식으로 나누어 나머지가 0인지 확인한다.
        - **MAC 주소 기반 통신** (LAN 내 통신)
            2계층은 같은 네트워크(LAN) 안에서의 통신으로, IP가 아니라 <u>MAC 주소를 이용해서 통신</u>한다.  
            (MAC 주소란 Media Access Control의 약자로, 네트워크 카드에 부여된 고유한 하드웨어 주소이다. 앞 3바이트는 제조사 번호고, 뒤 3바이트는 제조사 내 고유 번호이다.)
- **대표 프로토콜**
    - **Ethernet**
        가장 일반적인 유선 LAN 프로토콜로, MAC 주소 기반 통신을 한다.  
        CRC로 오류를 검출한다.
    - **PPP(Point-to-Point Protocol)**
        전화선이나 전용선처럼 일대일로 두 지점을 직접 연결한다.  
        Ethernet처럼 MAC 주소가 없고, 직접 두 장치만 연결된다.
    - **ARP(Address Resolution Protocol)**
        <u>IP 주소를 MAC 주소로 변환</u>하는 프로토콜이다.  
        → 3계층(IP)과 2계층(MAC)을 연결하는 중간 역할을 한다.  
        → ARP 요청을 브로드캐스트(LAN에서만 전파)로 보내고, 해당 IP를 가진 장치가 MAC 주소를 유니캐스트로 응답한다.
- **대표 장비**
    스위치(Switch), 브릿지(Bridge)  
    (브릿지는 두 개 이상의 LAN 세그먼트를 연결하고, MAC 주소를 기반으로 트래픽을 구분해주는 장치이다.)

### 3계층: 네트워크(Network)
    데이터가 <u>목적지까지 가는 경로를 결정</u>하는 계층이다.  
    <u>라우팅과 IP 주소를 관리</u>한다.
- **데이터 단위**
패킷(Packet)
- **주요 기능**
    - 논리 주소(IP) 부여
        (실제 하드웨어의 위치와 큰 관련이 없이 네트워크 상의 식별을 위한 주소로, IP를 논리 주소라고 한다.)
    - 라우팅 경로 결정
    - 단편화(Fragmentation)
        (현대엔 PMTUD로 라우터 단편화가 지양되고 있고, IPv6에서는 라우터 단편화가 금지되었다.)
- **대표 프로토콜**
    IP, ICMP, RIP, OSPF  
    (ARP는 2계층의 프로토콜이지만, 3계층 주소를 처리하기 때문에 2.5계층으로 볼 수 있다.)
- **대표 장비**
    라우터(Router), L3 스위치
#### 4계층: 전송(Transport)
    <u>종단 간(end-to-end) 신뢰성 있는 데이터 전송</u>을 담당한다.  
    송신자와 수신자 간의 데이터 흐름 제어 및 오류 복구를 한다.
- **데이터 단위**
    세그먼트(Segment, TCP), 데이터그램(Datagram, UDP)
- **주요 기능**
    - 신뢰성 보장
        (UDP는 이 중 오류 검출만을 지원하여 신뢰성을 보장하지는 않는다.)
    - 포트 번호로 프로세스 구분
- **대표 프로토콜**
    TCP, UDP

### 5계층: 세션(Session)
    통신하는 두 애플리케이션 간의 논리적 연결(세션)을 생성하고 관리하는 역할을 한다.  
    데이터를 단순히 주고받는 수준(4단계)보다 한 단계 위에서 <u>대화의 흐름을 제어하고 끊김 없이 유지</u>하는 것이 핵심이다.  
    → 사용자가 로그인하고, 파일을 업로드하고, 로그아웃하기까지 하나의 세션이 유지된다.  
    (현대 인터넷 스택인 TCP/IP에서는 이 세션 계층이 사실상 사라졌다. 이 기능은 전송 계층과 응용 계층으로 분산되었다.)
- **주요 기능**
    - **세션 설정**
        통신을 시작할 때 연결을 설정한다.  
        인증이나 핸드셰이크 과정을 포함한다.
    - **세션 유지**
        데이터 송수신 중 연결 상태를 지속 관리한다.  
        에러 발생 시 다시 동기화한다.
    - **세션 종료**
        통신이 끝나면 연결을 정상적으로 종료하고 자원을 해제한다.  
        비정상 종료 시 복구 절차를 수행한다.
    - **동기화(Synchronization)**
        대용량 데이터 전송 시 복구 지점(Checkpoint)를 설정한다.  
        전송 중 오류가 생겨도 처음부터가 아니라 복구 지점부터 재전송한다.
- **대표 프로토콜**
    NetBIOS, RPC(Remote Procedure Call)
- **예시**
    화상회의 중 세션 복구 기능

### 6계층: 표현(Presentation)
    데이터의 <u>형식(format)과 부호화(encoding)</u>를 담당한다.  
    → 전송되는 데이터가 정상적으로 보이도록 포맷을 맞춰주는 계층이다.
- **주요 기능**
    - **데이터 변환**
        서로 다른 시스템의 데이터 표현 방식을 통일한다.  
        (ASCII <→ EBCDIC, XML <→ JSON, 정수형 <→ 부동소수형 등)
    - **데이터 압축(Data Compression)**
        전송 효율을 높이기 위해 데이터의 크기를 줄인다.  
        (이미지 전송 시 JPEG, 텍스트 전송 시 gzip 등)
    - **데이터 암호화/복호화**
        송신 시에 데이터를 암호화하고, 수신 시에 복호화한다.  
        TLS/SSL은 전송계층 위에서 작동하지만, 암호화/복호화라는 점에서 표현 계층의 역할을 수행한다.
- **예시**
    웹에서 이미지 파일 전송 시 JPEG로 인코딩

### 7계층: 응용(Application)
    사용자와 직접 맞닿는 계층이다.  
    애플리케이션이 네트워크 서비스를 직접 이용할 수 있도록 <u>인터페이스를 제공</u>한다.  
    → 네트워크를 통해 데이터를 주고받을 수 있도록 해주는 프로토콜의 집합이다.
- **주요 기능**
    네트워크 서비스 제공(웹, 메일, 파일 전송 등)  
    사용자 인터페이스 제공
- **대표 프로토콜**
    HTTP, HTTPS, FTP, SMTP, DNS, SSH
- **예시**
    브라우저에서 URL 입력 → HTTP 요청  
    메일 클라이언트 → SMTP로 메일 전송

## 3 캡슐화와 역캡슐화
    각 계층을 거치면서 하위 계층으로 갈 수록 헤더가 씌워지는 캡슐화(Encapsulation) 과정이 일어나고, 다시 상위 계층으로 갈수록 헤더가 벗겨지는 역캡슐화(Decapsulation) 과정이 일어난다.
- **PDU(Protocol Data Unit)**
    네트워크 통신에서 각 계층이 처리하는 데이터의 기본 단위를 의미한다.
- **PDU 단위 표**
    | 계층  | 데이터 단위 (PDU)       | 예시                |
    | --- | ------------------ | ----------------- |
    | 7~5 | Data               | HTTP 요청, 파일 데이터 등 |
    | 4   | Segment / Datagram | TCP/UDP 세그먼트      |
    | 3   | Packet             | IP 패킷             |
    | 2   | Frame              | Ethernet 프레임      |
    | 1   | Bit                | 0과 1의 신호          |